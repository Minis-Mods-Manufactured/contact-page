<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home Price Calculator | Affordable Homes of Crestview</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 30px 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    p {
      text-align: center;
      max-width: 700px;
      margin: 0 auto 40px;
    }
    .calculator-form label {
      font-weight: bold;
      display: block;
      margin-top: 20px;
    }
    .calculator-form input,
    .calculator-form select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      font-size: 1rem;
    }
    .calculator-result {
      margin-top: 40px;
    }
    .section-divider {
      margin: 40px 0 30px;
    }
    .blue-box {
      background-color: #e8f0ff;
      border-radius: 8px;
      padding: 20px;
    }
    table {
      width: 100%;
      font-size: 16px;
    }
    td {
      padding: 5px 0;
    }
    .info-icon {
      display: inline-block;
      margin-left: 5px;
      color: #888;
      cursor: pointer;
    }
    .tooltip {
      visibility: hidden;
      width: 300px;
      background-color: #555;
      color: #fff;
      text-align: left;
      border-radius: 6px;
      padding: 8px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      margin-left: -150px;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .info-icon:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <div id="shared-header"></div>
  <div class="container">
    <h1>üè° Home Price & Down Payment Estimator</h1>
    <p>Estimate taxes, land improvements, and down payments based on your home project total. <p>
<p style="text-align: center; margin-top: 10px;">
  The dealership requires a $1,000 deposit to start your permits/site evaluation.
</p>
    <form onsubmit="event.preventDefault(); calculate();" class="calculator-form">
      <label for="loanType">Loan Type:</label>
      <select id="loanType" name="loanType" onchange="updateForm()">
        <option value="landhome">Land + Home Loan</option>
        <option value="homeonly">Home Only Loan</option>
      </select>

      <label for="price">Enter Home Price ($):</label>
      <input type="text" id="price" name="price" placeholder="e.g. 200000" required />

      <div id="landCostSection">
        <label for="land">Enter Land Cost ($):</label>
        <input type="text" id="land" name="land" placeholder="e.g. 30000" />
      </div>
      
      <!-- Home Type Section -->
<label for="homeType">Home Type:</label>
<select id="homeType" name="homeType">
  <option value="double">Doublewide</option>
  <option value="single">Singlewide</option>
</select>
<small style="display:block; margin-top:4px; color:gray;">
  (For government-backed land/home loans, we add $5,000 to Singlewides and $10,000 to Doublewides for additional requirements. This amount is added to land improvements but is not taxed.)
</small>
      
      <label for="improvements">Enter Land Improvements ($):</label>
      <input type="text" id="improvements" name="improvements" placeholder="e.g. 15000" />

      <label for="state">Select State:</label>
      <select id="state" name="state">
        <option value="fl">Florida</option>
        <option value="al">Alabama</option>
      </select>

      <label for="county">If FL, Choose County:</label>
      <select id="county" name="county">
        <option value="escambia">Escambia County</option>
        <option value="other">Other FL County</option>
      </select>

      <label for="loanProgram">Loan Program:</label>
      <select id="loanProgram" name="loanProgram"></select>
    </form>

    <div id="result" class="calculator-result"></div>
    <hr class="section-divider" />

    <div class="calculator-result blue-box">
      <h3 style="text-align: center;">üí∞ Estimated Down Payment & Loan Amount </h3>
          <span class="tooltip">
            ‚Ä¢ Government-backed loans (VA/USDA/FHA) require land to qualify.<br />
            ‚Ä¢ Conventional loans (5%, 10%, 20%) are used for home-only.<br />
            ‚Ä¢ Some lenders may approve 0% down conventional with 750+ score.<br />
            ‚Ä¢ $1,000 deposit required by builder on all loans to begin work.
          </span>
        </span>
      </h3>
      <div id="financeSummary"></div>
    </div>
  </div>

  <script>
  const loanProgram = document.getElementById('loanProgram');
  const loanType = document.getElementById('loanType');
  const homeType = document.getElementById('homeType');
  const landSection = document.getElementById('landCostSection');
  const state = document.getElementById('state');
  const county = document.getElementById('county');

  const price = document.getElementById('price');
  const land = document.getElementById('land');
  const improvements = document.getElementById('improvements');
  const result = document.getElementById('result');
  const financeSummary = document.getElementById('financeSummary');

  function parse(val) {
    return parseFloat(val.replace(/,/g, '')) || 0;
  }

  function format(num) {
    return num.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
  }

  function updateForm() {
    const isHomeOnly = loanType.value === 'homeonly';
    landSection.style.display = isHomeOnly ? 'none' : 'block';

    loanProgram.innerHTML = isHomeOnly
      ? `<option value="conv5">5% down (Conventional)</option>
         <option value="conv10">10% down (Conventional)</option>
         <option value="conv20">20% down (Conventional)</option>`
      : `<option value="va">VA/USDA - 0% down (Gov't-Backed)</option>
         <option value="fha">FHA - 3.5% down (Gov't-Backed)</option>
         <option value="conv5">5% down (Conventional)</option>
         <option value="conv10">10% down (Conventional)</option>
         <option value="conv20">20% down (Conventional)</option>`;

    calculate(); // trigger calculation immediately when form updates
  }

  function calculate() {
    const homePrice = parse(price.value);
    const landPrice = parse(land.value);
    const baseImp = parse(improvements.value);
    const isFL = state.value === 'fl';
    const isEscambia = county.value === 'escambia';
    const isHomeOnly = loanType.value === 'homeonly';
    const selectedLoan = loanProgram.value;
    const selectedHomeType = homeType?.value || 'double';

    // Add additional costs ONLY for land + home government-backed loans
    let govAddOn = 0;
    const isGovLoan = ['va', 'fha'].includes(selectedLoan);
    if (!isHomeOnly && isGovLoan) {
      govAddOn = selectedHomeType === 'single' ? 5000 : 10000;
    }

    const totalImp = baseImp + govAddOn;

    // Calculate taxes
    const taxableAmount = homePrice + (isHomeOnly ? totalImp : 0);
    let tax = 0;
    if (isFL) {
      tax = taxableAmount * 0.03 + (isEscambia ? 75 : 50);
    } else {
      tax = taxableAmount * 0.055;
    }

    const homeSubtotal = homePrice + totalImp + tax;
    const landSubtotal = isHomeOnly ? 0 : landPrice;
    const total = homeSubtotal + landSubtotal;

    // Down payment % based on loan type
    let dpPercent = 0;
    switch (selectedLoan) {
      case 'fha': dpPercent = 0.035; break;
      case 'conv5': dpPercent = 0.05; break;
      case 'conv10': dpPercent = 0.10; break;
      case 'conv20': dpPercent = 0.20; break;
      default: dpPercent = 0; break; // VA/USDA
    }

    const dp = total * dpPercent;
    const financed = total - dp;

    result.innerHTML = `
      <table>
        <tbody>
          <tr><td>üè° Home Price:</td><td style="text-align:right">${format(homePrice)}</td></tr>
          <tr><td>üì¶ Land Improvements:</td><td style="text-align:right">${format(baseImp)}</td></tr>
          ${govAddOn > 0 ? `<tr><td>‚ûï Gov't-Backed Add-on:</td><td style="text-align:right">${format(govAddOn)}</td></tr>` : ''}
          <tr><td>üí∞ Taxes & Surtax:</td><td style="text-align:right">${format(tax)}</td></tr>
          <tr><td><strong>üè† House Subtotal:</strong></td><td style="text-align:right"><strong>${format(homeSubtotal)}</strong></td></tr>
          ${!isHomeOnly ? `
            <tr><td>üåæ Land:</td><td style="text-align:right">${format(landPrice)}</td></tr>
            <tr><td><strong>üå≥ Land Subtotal:</strong></td><td style="text-align:right"><strong>${format(landSubtotal)}</strong></td></tr>
          ` : ''}
          <tr><td colspan="2"><hr /></td></tr>
          <tr><td><strong>üí≥ Estimated Total:</strong></td><td style="text-align:right"><strong>${format(total)}</strong></td></tr>
        </tbody>
      </table>
    `;

    financeSummary.innerHTML = `
      <table>
        <tbody>
          <tr><td>Down Payment (${(dpPercent * 100).toFixed(1)}%):</td><td style="text-align:right">${format(dp)}</td></tr>
          <tr><td>Amount to Finance:</td><td style="text-align:right">${format(financed)}</td></tr>
        </tbody>
      </table>
    `;
  }

  // Event listeners
  [price, land, improvements].forEach(input => input.addEventListener('input', calculate));
  [loanType, loanProgram, state, county, homeType].forEach(el => el.addEventListener('change', () => {
    if (el === loanType) updateForm();
    else calculate();
  }));

  updateForm(); // initial setup
</script>

</body>
</html>
