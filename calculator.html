<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Home Price Calculator | Affordable Homes of Crestview</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 30px 20px;
    }

    h1 {
      text-align: center;
      margin-bottom: 20px;
    }

    p {
      text-align: center;
      max-width: 700px;
      margin: 0 auto 40px;
    }

    .calculator-form label {
      font-weight: bold;
      display: block;
      margin-top: 20px;
    }

    .calculator-form input,
    .calculator-form select {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      font-size: 1rem;
    }

    .calculator-result {
      margin-top: 40px;
    }

    .section-divider {
      margin: 40px 0 30px;
    }

    .blue-box {
      background-color: #e8f0ff;
      border-radius: 8px;
      padding: 20px;
    }

    table {
      width: 100%;
      font-size: 16px;
    }

    td {
      padding: 5px 0;
    }

    .info-icon {
      display: inline-block;
      margin-left: 5px;
      cursor: help;
    }
  </style>
</head>
<body>

  <div id="shared-header"></div>

  <div class="container">
    <h1>üè° Home Price & Down Payment Estimator</h1>
    <p>Use this calculator to estimate taxes, land improvement costs, and typical loan down payments based on your project total.</p>

    <form onsubmit="event.preventDefault(); calculateTax();" class="calculator-form">
      <label for="loanType">Loan Type:</label>
      <select id="loanType" name="loanType">
        <option value="landhome">Land & Home</option>
        <option value="homeonly">Home Only</option>
      </select>

      <label for="loanProgram">Loan Program:</label>
      <select id="loanProgram" name="loanProgram">
        <option value="va">VA (Government-backed)</option>
        <option value="usda">USDA (Government-backed)</option>
        <option value="fha">FHA (Government-backed)</option>
        <option value="5">5% Down (Conventional)</option>
        <option value="10">10% Down (Conventional)</option>
        <option value="20">20% Down (Conventional)</option>
      </select>

      <label for="price">Enter Home Price ($):</label>
      <input type="text" id="price" name="price" placeholder="e.g. 200000" required />

      <div id="land-cost-group">
        <label for="land">Enter Land Cost ($):</label>
        <input type="text" id="land" name="land" placeholder="e.g. 30000" />
      </div>

      <label for="improvements">Enter Land Improvements ($):</label>
      <input type="text" id="improvements" name="improvements" placeholder="e.g. 15000" />

      <p style="font-size: 14px; color: #555;">
        üí° Common land improvements include site clearing, septic or sewer setup, water access (well or tap), grading, and utility hookups.
      </p>
    </form>

    <div id="result" class="calculator-result"></div>

    <hr class="section-divider" />

    <div class="calculator-result blue-box">
      <h3 style="text-align: center;">üí∞ Typical Down Payments
        <span class="info-icon" title="Note: All loan types require a $1,000 deposit to the dealer for site evaluation and permits. Government-backed loans require land. Some buyers with 750+ credit scores may qualify for lender-specific 0% down options.">‚ÑπÔ∏è</span>
        <br><small>Based on the full estimated project total:</small></h3>
      <table>
        <thead>
          <tr>
            <th style="text-align:left;">Loan Program</th>
            <th style="text-align:right;">Down Payment</th>
            <th style="text-align:right;">Amount to Finance</th>
          </tr>
        </thead>
        <tbody>
          <tr id="row-5">
            <td>5% Down (Conventional):</td>
            <td style="text-align:right;"><span id="dp-5">$0.00</span></td>
            <td style="text-align:right;"><span id="loan-5">$0.00</span></td>
          </tr>
          <tr id="row-10">
            <td>10% Down (Conventional):</td>
            <td style="text-align:right;"><span id="dp-10">$0.00</span></td>
            <td style="text-align:right;"><span id="loan-10">$0.00</span></td>
          </tr>
          <tr id="row-20">
            <td>20% Down (Conventional):</td>
            <td style="text-align:right;"><span id="dp-20">$0.00</span></td>
            <td style="text-align:right;"><span id="loan-20">$0.00</span></td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>

  <script>
    const priceInput = document.getElementById('price');
    const landInput = document.getElementById('land');
    const improvementsInput = document.getElementById('improvements');
    const loanTypeSelect = document.getElementById('loanType');
    const loanProgramSelect = document.getElementById('loanProgram');
    const resultDiv = document.getElementById('result');
    const landGroup = document.getElementById('land-cost-group');

    function parseFormattedNumber(value) {
      return parseFloat(value.replace(/,/g, '')) || 0;
    }

    function formatCurrency(num) {
      return num.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
    }

    function formatInputValue(input) {
      const raw = input.value.replace(/,/g, '');
      if (!/^\d*$/.test(raw)) return;
      input.value = Number(raw).toLocaleString('en-US');
    }

    function attachLiveFormat(input) {
      input.addEventListener('input', () => {
        formatInputValue(input);
        input.setSelectionRange(input.value.length, input.value.length);
        calculateTax();
      });
    }

    function calculateTax() {
      const price = parseFormattedNumber(priceInput.value);
      const land = loanTypeSelect.value === 'homeonly' ? 0 : parseFormattedNumber(landInput.value);
      const improvements = parseFormattedNumber(improvementsInput.value);

      const loanType = loanTypeSelect.value;
      const totalTax = price * 0.03 + (loanType === 'homeonly' ? improvements * 0.03 : 0);

      const total = price + improvements + land + totalTax;

      resultDiv.innerHTML = `
        <table><tbody>
          <tr><td>üè† Home Price:</td><td style="text-align:right;">${formatCurrency(price)}</td></tr>
          <tr><td>üí∞ Taxes:</td><td style="text-align:right;">${formatCurrency(totalTax)}</td></tr>
          <tr><td><strong>üè° Subtotal:</strong></td><td style="text-align:right;"><strong>${formatCurrency(price + totalTax)}</strong></td></tr>
          <tr><td>üõ†Ô∏è Land Improvements:</td><td style="text-align:right;">${formatCurrency(improvements)}</td></tr>
          ${loanType === 'landhome' ? `<tr><td>üåæ Land Cost:</td><td style="text-align:right;">${formatCurrency(land)}</td></tr>` : ''}
          <tr><td colspan="2"><hr></td></tr>
          <tr><td><strong>üíµ Estimated Total:</strong></td><td style="text-align:right;"><strong>${formatCurrency(total)}</strong></td></tr>
        </tbody></table>
      `;

      const updateDP = (pct) => {
        const dp = total * (pct / 100);
        document.getElementById(`dp-${pct}`).textContent = formatCurrency(dp);
        document.getElementById(`loan-${pct}`).textContent = formatCurrency(total - dp);
      };

      updateDP(5);
      updateDP(10);
      updateDP(20);
    }

    [priceInput, landInput, improvementsInput].forEach(attachLiveFormat);
    [loanTypeSelect, loanProgramSelect].forEach(el => el.addEventListener('change', () => {
      landGroup.style.display = loanTypeSelect.value === 'homeonly' ? 'none' : 'block';
      calculateTax();
    }));

    calculateTax();
  </script>
</body>
</html>
